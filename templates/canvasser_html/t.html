{% extends "header.html" %}

{% block header %}
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="/static/javascript/bs_js/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <!-- Custom styles for this login page -->
    <link href="/static/css/canvasser.css" rel="stylesheet">
    <link href="/static/css/view_upcoming.css" rel="stylesheet">

{% endblock %}

<!----------------------BODY PART---------------------------------------------->
{% block body %}
    <!-- main functional parts -->
      <h1 style="text-align: center;padding-top:10px;">Assignments</h1>
      <hr/>
    <button class="btn btn-info" type="button" style="margin-left:5%" id="canHome" onclick="window.location.href='{{ url_for( 'canvasser.canPage', u_name = session['info']['name'])}}' ">HomePage</button><br/><br/>
    <!-------------Title---------------->
     <h4 style="margin-left:5%"><span style="padding-left:5px; font-weight: bold;">Basic Instructions : </span></h4>
     <h5 style="margin-left:10%">You have two ways to see your assigment details<br/>
        <ul>
              <li>Select from assignements list</li>
              <li> Click the location marker on the map</li>
        </ul>  
    </h5><hr/>
      <div class="form-group form-inline">
         <label class="col-1" style="font-weight:bold; font-size: 20px; margin-left:20%;" for ="assignment"> Location:</label>
        <input class="form-control col-4" id ="assignment" type="text" name="assignment" placeholder = "Assignment Location" readonly autofocus>
        <button class='btn btn-primary' style="margin-left: 3%; font-size: 18px;">See Details</button>
    </div>
        <!-------------Select one assignments from the list-------------->
      <h4 style="margin-left:5%"><span style="padding-left:5px; font-weight: bold; padding-right: 5px;">1, Select from the list </span><i class="fa fa-search-plus fa-lg"></i></h4>
      <div class="dropdown" style="margin-left: 5%">
            <button class="btn btn-dark dropdown-toggle" type="button" id="assignment" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Assignments List
            </button>
            <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
               {% for instance in assignments %}
                <button class="dropdown-item" type="button" value="{{ instance.id}}" onclick="window.location.href='{{ url_for('canvasser.view_assigment_detail', ass_id = instance.id)}}' ">Assignment {{instance.order}}</button>
                {% endfor %}
            </div>
      </div><br/>
 <!-------------Select one assignments through clicking the map marker-------------->
    <h4 style="margin-left:5%"><span style="padding-left:5px; font-weight: bold; padding-right: 10px;">2, Click on the map marker</span><i class="fa fa-map-marker fa-lg"></i></h4>
    <div class="form-group form-inline">

        <div id="map" name="map" class="col-lg-8" style="margin-left: 10%; height: 350px;background-color: grey"></div>
    </div>
    <hr/>
<!----------------- Viiew Assignment Detail-------------->
    <div class="col-md-8" style="margin-left: 20%" {% if detail %} display="block" {% else %} display="none" {% endif %}>
        <div class="card-body">
            <div class="row">
               <div class="col-md-12">
                 <h4><i class="fa fa-info-circle fa-lg"></i><span style="padding-left:10px; font-weight: bold;">Assignment Information</span></h4> 
                 <hr/>
                </div>
            </div>
            <!---------Details----------->
            <div class="row">
                <div class="col-md-12">
                    <form>
                        <!-------- Canvasser Name--------->  
                        <div class="form-group row">
                          <label for="username" class="col-3 col-form-label">Canvasser Name:</label> 
                            <div class="col-6">
                                <input id="username" name="username" placeholder="Canvaser Name" class="form-control here" readonly type="text" autofocus>
                                </div>
                        </div>
                        <!--------Campaingn Name--------->  
                        <div class="form-group row">
                          <label for="campName" class="col-3 col-form-label">Campaign Name:</label> 
                            <div class="col-6">
                                <input id="campName" name="campName" placeholder="Campagin Name" class="form-control here" {% if detail %} value="{{ detail['campaign_name'] }}" {% endif %} readonly type="text">
                                </div>
                        </div>
                        <!---------Date------------>
                        <div class="form-group row">
                                <label for="date" class="col-3 col-form-label">Date:</label> 
                                <div class="col-8">
                                  <input id="date" name="date" placeholder="Assignment Date" class="form-control" type="text" {% if detail %} value="{{ detail['assignment'].theDate }}" {% endif %}readonly>
                                </div>
                        </div>
                        <!---------Location Address------------>
                        <div class="form-group row">
                                <label for="location" class="col-3 col-form-label">Location:</label> 
                                <div class="col-8">
                                  <input id="location" name="location" placeholder="Assignment Location" class="form-control" type="text" {% if detail %} value="{{ detail['location'][0] }}" {% endif %} readonly>
                                </div>
                        </div>                        
                         <!---------Lat------------>
                        <div class="form-group row">
                                <label for="lat" class="col-3 col-form-label">Latitude:</label> 
                                <div class="col-8">
                                  <input id="lat" name="lat" placeholder="Location Lat" class="form-control" type="text" {% if detail %} value="{{ detail['location'][1] }}" {% endif %} readonly>
                                </div>
                        </div>
                         <!---------Lng------------>
                        <div class="form-group row">
                                <label for="lng" class="col-3 col-form-label">Longtitude:</label> 
                                <div class="col-8">
                                  <input id="lng" name="lng" placeholder="Location Lng" class="form-control" type="text" {% if detail %} value="{{ detail['location'][2] }}" {% endif %} readonly>
                                </div>
                        </div>
                        <!---------Talking Point--------->
                        <div class="form-group row">
                                <label for="talking" class="col-3 col-form-label">Talking Point</label> 
                                <div class="col-8">
                                  <input id="talking" name="talking" placeholder="Assignment Talking Point" class="form-control" type="text" {% if detail %} value="{{ detail['talking'] }}" {% endif %} readonly>
                                </div>
                        </div>

                        <!---------Questions--------->                    
                        <div class="form-group row">
                            <label for="questions" class="col-3 col-form-label">Assignment Questionaire</label> 
                                <div class="col-8">
                                  <select class="col-8" id="questions" name="questions" readonly>
                                    {% for q in detail['questions'] %}
                                    <option>{{ q.question }}</option>
                                    {% endfor %}
                                  </select>
                                </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
    <!----------------Loading locations for creating markers on Map-------->
    <script>
      {% for location in %}
          {% with errors = get_flashed_messages() %}
      {% if errors %}
        {% for msg in errors %}
             alert('{{ msg }}');
        {% endfor %}
     {% endif %}
  {% endwith %}
    </script>
    <!-- map js files--> 
    <script  src="/static/javascript/canvasser_script/viewAssignment.js"></script> 
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGuEpRycbTYDCcS6uxiot0x0eSLkpTbiY&libraries=places&callback=initAutocomplete"></script>
{%  endblock %}